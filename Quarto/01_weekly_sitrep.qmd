---
title: "PEARL Weekly Situation Report"
date: "`r Sys.Date()`"
format: 
  html: default
execute:
  echo: false
  message: false
  warning: false
---

```{r}
#| label: Load data

# Load necessary libraries
library(here)
library(flextable)

# Source scripts for data loading and tidying
source(here("R", "02_load_data.R"))
source(here("R", "03_tidy_data.R"))

# Automatically source all scripts in ~/R that start with 05 or 06
script_dir <- here("R")
script_files <- list.files(path = script_dir, pattern = "^(05|06).*\\.R$", full.names = TRUE)

if (length(script_files) > 0) {
  invisible(lapply(script_files, function(script) {
    message("Sourcing: ", script)
    tryCatch(
      source(script),
      error = function(e) message("Error in ", script, ": ", e$message)
    )
  }))
} else {
  message("No matching scripts found in: ", script_dir)
}
```

# Activity This Week

## Summary Table

```{r}
#| label: Summary flextable

flextable::htmltools_value(table_06.01)
```

# Screening Progress

```{r}
#| label: Progress plots
print(map_05.07)
```

```{r}
#| label: Age pyramid
print(plot_05.02)
```

```{r}
#| label: EA props
print(plot_05.03)
```

## Weekly activities over time

```{r}
#| label: Weekly activities
print(plot_05.01)
```

```{r}
#| label: Weekly quality
print(plot_05.08)
```

## Cumulative screening participation and coverage by village

```{r}
#| label: Cumulative village

print(plot_05.05)
```

## Coverage progress by village

```{r}
#| label: Cumulative village prop

print(plot_05.04)
```

# TB Preventive Treatment

*TBD*

# Linkage to Care

*TBD*

# Plan for Next Week

*TBD*
